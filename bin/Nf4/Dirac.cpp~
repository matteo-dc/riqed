#include "read.hpp"
#include "aliases.hpp"

//create Dirac Gamma matrices
vprop_t make_gamma()
{
    int NGamma=16;
    
    vprop_t gam(NGamma);
    vector< vector<int> > col(NGamma, vector<int>(4));
    vector< vector<int> > real_part(NGamma, vector<int>(4));
    vector< vector<int> > im_part(NGamma, vector<int>(4));
    
    //Identity=gamma0
    col[0]={0,1,2,3};
    real_part[0]={1,1,1,1};
    im_part[0]={0,0,0,0};
    //gamma1
    col[1]={3,2,1,0};
    real_part[1]={0,0,0,0};
    im_part[1]={-1,-1,1,1};
    //gamma2
    col[2]={3,2,1,0};
    real_part[2]={-1,1,1,-1};
    im_part[2]={0,0,0,0};
    //gamma3
    col[3]={2,3,0,1};
    real_part[3]={0,0,0,0};
    im_part[3]={-1,1,1,-1};
    //gamma4
    col[4]={2,3,0,1};
    real_part[4]={-1,-1,-1,-1};
    im_part[4]={0,0,0,0};
    //gamma5
    col[5]={0,1,2,3};
    real_part[5]={1,1,-1,-1};
    im_part[5]={0,0,0,0};
    
    for(int i_gam=0;i_gam<6;i_gam++)
        for(int i_row=0;i_row<4;i_row++)
            for(int ic=0;ic<3;ic++)
            {
                gam[i_gam](isc(i_row,ic),isc(col[i_gam][i_row],ic))=dcompl(real_part[i_gam][i_row],im_part[i_gam][i_row] );
            }
    
    //gamma_mu*gamma5
    for(int j=0;j<4;j++)
    {
        gam[6+j]=gam[1+j]*gam[5];
    }
    //sigma
    size_t ind1[6]={2,3,1,4,4,4};
    size_t ind2[6]={3,1,2,1,2,3};
    for(int i=0;i<6;i++)
        gam[10+i]=0.5*(gam[ind1[i]]*gam[ind2[i]]-gam[ind2[i]]*gam[ind1[i]]);
    
    return gam;
}
